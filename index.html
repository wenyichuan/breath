<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>478å‘¼å¸æ³•æ™ºèƒ½è®¡æ—¶å™¨</title>
    <style>
        body {
            background: #e0f7fa;
            display: flex;
            flex-direction: column;
            align-items: center;
            font-family: 'Segoe UI', Arial, sans-serif;
        }

        #timer-container {
            width: 300px;
            height: 300px;
            border-radius: 50%;
            background: #81d4fa;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 2rem;
            transition: background 0.5s;
        }

        #time-display {
            font-size: 6vw;
            color: #01579b;
            font-weight: 700;
        }

        .phase-indicator {
            display: flex;
            gap: 20px;
            margin-bottom: 2rem;
        }

        .phase-dot {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            opacity: 0.3;
        }

        .active {
            opacity: 1;
        }

        button {
            padding: 12px 24px;
            margin: 10px;
            border: none;
            border-radius: 25px;
            background: #4fc3f7;
            color: white;
            cursor: pointer;
            transition: transform 0.2s;
        }

        #guidance-text {
            font-size: 2.5rem;
            color: #01579b;
            margin: 20px 0;
            min-height: 60px;
            transition: opacity 0.3s;
        }

        .phase-instruction {
            animation: fadeInOut 1.5s ease-in-out;
        }

        @keyframes fadeInOut {
            0% {
                opacity: 0;
                transform: translateY(10px);
            }
            20% {
                opacity: 1;
                transform: translateY(0);
            }
            80% {
                opacity: 1;
                transform: translateY(0);
            }
            100% {
                opacity: 0;
                transform: translateY(-10px);
            }
        }

        button:hover {
            transform: scale(1.1);
        }
    </style>
</head>
<body>
<h1>478å‘¼å¸æ³•æ™ºèƒ½è®¡æ—¶å™¨</h1>

<div class="phase-indicator">
    <div class="phase-dot" id="inhale" style="background: #2196f3;"></div>
    <div class="phase-dot" id="hold" style="background: #ffd54f;"></div>
    <div class="phase-dot" id="exhale" style="background: #81c784;"></div>
</div>

<div id="timer-container">
    <div id="time-display">0</div>
</div>

<!-- å¼•å¯¼æ–‡å­—å®¹å™¨ -->
<div id="guidance-text"></div>

<div>
    <button id="startBtn">å¼€å§‹å†¥æƒ³</button>
    <button id="pauseBtn">æš‚åœè°ƒæ•´</button>
    <button id="resetBtn">é‡ç½®å¾ªç¯</button>
</div>

<script>
    // æ‰©å±•é˜¶æ®µå¼•å¯¼æ–‡æ¡ˆåº“ 
    const phaseMessages = {
        inhale: [
            "ğŸŒ¬ï¸ æ·±å¸æ°”4ç§’ï¼Œè®©ç©ºæ°”å……æ»¡è‚ºéƒ¨",
            "ğŸ‘ƒ ç”¨é¼»è…”ç¼“æ…¢å¸æ°”ï¼Œæ„Ÿå—æ¨ªè†ˆè†œä¸‹æ²‰",
            "â³ å¸æ°”è¿›è¡Œä¸­... å‰©ä½™{{time}}ç§’"
        ],
        hold: [
            "â¸ï¸ å±æ¯7ç§’ï¼Œä¿æŒèº«ä½“ç¨³å®š",
            "ğŸ§˜ æ„Ÿå—æ°§æ°”åœ¨è¡€æ¶²ä¸­æµåŠ¨",
            "â³ å±æ¯ä¿æŒä¸­... å‰©ä½™{{time}}ç§’"
        ],
        exhale: [
            "ğŸŒªï¸ ç¼“æ…¢å‘¼æ°”8ç§’ï¼Œå½»åº•æ’ç©ºè‚ºéƒ¨",
            "ğŸ‘„ é€šè¿‡å˜´å”‡ç¼éš™æ§åˆ¶å‘¼å‡ºé€Ÿåº¦",
            "â³ å‘¼æ°”è¿›è¡Œä¸­... å‰©ä½™{{time}}ç§’"
        ]
    };
    const phases = [
        {name: 'å¸æ°”', duration: 4, color: '#81d4fa'},
        {name: 'å±æ¯', duration: 7, color: '#fff176'},
        {name: 'å‘¼æ°”', duration: 8, color: '#a5d6a7'}
    ];

    function updateGuidanceText() {
        const guidanceEl = document.getElementById('guidance-text');
        const phaseType = ['inhale', 'hold', 'exhale'][currentPhase];
        const messages = phaseMessages[phaseType];

        // åŠ¨æ€é€‰æ‹©å¼•å¯¼è¯­ï¼ˆæ ¹æ®æ—¶é—´è¿›åº¦ï¼‰
        let msgIndex = 0;
        if (timeLeft <= phases[currentPhase].duration - 2) msgIndex = 1;
        if (timeLeft <= 3) msgIndex = 2;

        // æ’å…¥æ—¶é—´å˜é‡ 
        let text = messages[msgIndex].replace("{{time}}", timeLeft);

        // æ·»åŠ åŠ¨ç”»æ•ˆæœ 
        guidanceEl.innerHTML = `<span class="phase-instruction">${text}</span>`;
    }

    let currentPhase = 0;
    let timeLeft = phases[0].duration;
    let timer = null;
    let isRunning = false;

    function updateDisplay() {
        document.getElementById('time-display').textContent = timeLeft;
        document.getElementById('timer-container').style.background = phases[currentPhase].color;
        document.querySelectorAll('.phase-dot').forEach(dot => dot.classList.remove('active'));
        document.querySelectorAll('.phase-dot')[currentPhase].classList.add('active');
    }

    function startCycle() {
        if (timer) clearInterval(timer); // æ¸…é™¤å†å²å®šæ—¶å™¨ 
        isRunning = true;
        updateDisplay();  // ç«‹å³æ˜¾ç¤ºåˆå§‹å€¼ 
        timer = setInterval(() => {
            timeLeft--;
            if (timeLeft <= 0) {
                currentPhase = (currentPhase + 1) % phases.length;
                timeLeft = phases[currentPhase].duration;
            }
            updateDisplay();
            updateGuidanceText(); // æ–°å¢æ–‡å­—å¼•å¯¼æ›´æ–° 
        }, 1000);
    }

    // æš‚åœæŒ‰é’®äº‹ä»¶ 
    document.getElementById('pauseBtn').addEventListener('click', () => {
        clearInterval(timer);
        isRunning = false; // è§£é™¤è¿è¡Œé” 
    });

    // é‡ç½®æŒ‰é’®äº‹ä»¶ 
    document.getElementById('resetBtn').addEventListener('click', () => {
        clearInterval(timer);
        currentPhase = 0;
        timeLeft = phases[0].duration;
        isRunning = false; // çŠ¶æ€å½’ä½ 
        updateDisplay();
    });

    document.getElementById('startBtn').addEventListener('click', startCycle);
    document.getElementById('pauseBtn').addEventListener('click', () => clearInterval(timer));
    document.getElementById('resetBtn').addEventListener('click', () => {
        clearInterval(timer);
        currentPhase = 0;
        timeLeft = phases[0].duration;
        updateDisplay();
    });
</script>
</body>
</html>

